apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-file-secret-provider
  namespace: ns-portalfront-app
spec:
  provider: azure

  secretObjects:
  - secretName: front-app-storage-key    # you can rename this later if you want
    type: Opaque
    data:
    - objectName: front-app-storage-name   # KV secret: storage account name
      key: azurestorageaccountname      # K8s secret key
    - objectName: front-app-storage-key    # KV secret: **account key**
      key: azurestorageaccountkey       # K8s secret key EXPECTED by Azure File CSI

  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "false"
    useAzureWorkloadIdentity: "true"

    clientID: "efa22614-3d66-42c1-bda7-c963ce1aae08"
    keyvaultName: "kv-portalxm-prb-01"
    cloudName: ""
    objects: |
      array:
        - |
          objectName: front-app-storage-name
          objectType: secret
          objectVersion: ""
        - |
          objectName: front-app-storage-key    # ðŸ‘ˆ use KEY, not SAS token
          objectType: secret
          objectVersion: ""
    tenantId: "123-0b5c-48bc-bd1a-123"
